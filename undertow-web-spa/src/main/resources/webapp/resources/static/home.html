<!DOCTYPE html>
<html lang="en">
<head>
    <title>Home</title>

    <meta http-equiv="Cache-Control" content="no-store" />
    <meta charset="UTF-8">

    <script src="/js/header.js"></script>
    <script src="/js/utils.js"></script>

    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>

<div id='output'></div>

<script>

    docReady(async function () {


        let items = await fetch('/api/cities')
            .then(res => res.json())
            .then(json => {
                return json;
            })
            .catch(function(error) {
                console.log(error);
            });

        document.getElementById("output").innerHTML = json2Table(items);
    });

    function json2Table(json) {

        let headerRow = `<tr>
                      <th>ID</th>
                      <th>Name</th>
                      <th>Action</th>
                     </tr>`

        let rows = json
            .map(city => {
                return `
              <tr>

                <td>${city.id}</td>
                <td>${city.name}</td>
                <td>
                <form action="/neighbours" method="get">
                   <input type="submit" value="Start">
                   <input type="hidden" name="cname" value="${city.name}"/>
                </form>
                </td>

              </tr>
              `
            });

        const table = `
        	<table>
		      <thead>
		    	<tr>${headerRow}</tr>
		      <thead>
		      <tbody>
		    	${rows.join('')}
		      <tbody>
	        <table>
        `;

        return table;
    }


</script>

</body>
</html>